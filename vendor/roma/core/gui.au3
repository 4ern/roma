
;----------------------------------------------------------------------------------------------/
; Initialisiere die GUI
;----------------------------------------------------------------------------------------------/
func _vendor_roma_core_gui__initail()
	
	;----------------------------------------------------------------------------------------------/
	; Ermittle welche GUI genutzt werden soll
	;----------------------------------------------------------------------------------------------/
	$gui_typ = IniRead($ROOT & '\config\gui.ini', 'gui-typ', $APP('DEBUG') = 'true' ? 'develop' : 'production', 'browser')

	;----------------------------------------------------------------------------------------------/
	; execute gui function
	;----------------------------------------------------------------------------------------------/
	if $gui_typ = 'browser' then ShellExecute('http://' & $APP('IP') & ':' & $APP('PORT'))
	Call('_vendor_roma_core_gui__' & $gui_typ)
endfunc

#cs
|-----------------------------------------------------------------------------------------------/
| IE Sektion
|-----------------------------------------------------------------------------------------------/
|
| Erstellung einer AutoIt GUI mit IE Embedded
|
#ce
func _vendor_roma_core_gui__ie()
	
	;----------------------------------------------------------------------------------------------/
	; Setze GUIONEVENT
	;----------------------------------------------------------------------------------------------/
	Opt('GUIOnEventMode', 1)

	;----------------------------------------------------------------------------------------------/
	; Erstelle ie Embedded
	;----------------------------------------------------------------------------------------------/
	;~ _IECreate('http://' & $APP('IP') & ':' & $APP('PORT'))
	$oIE = _IECreateEmbedded()

	;----------------------------------------------------------------------------------------------/
	; Holle die GUI Settings
	; Array Info
	;		Row | 	Col 0 	| 	Col 1
	;		[0] | 	7 
	;		[1] |	width 	|   Value
	;		[2] |	height 	|   Value
	;		[3] |	left 	|   Value
	;		[4] |	top 	|   Value
	;		[5] |	style 	|   Value
	;		[6] |	exstyle |   Value
	;----------------------------------------------------------------------------------------------/
	$aGuiSettings = IniReadSection($ROOT & '\config\gui.ini', 'ie')
	$style        = (StringLeft( $aGuiSettings[5][1], 1) = '$') ? eval(StringTrimLeft( $aGuiSettings[5][1], 1)) :  $aGuiSettings[5][1]
	$exStyle      = (StringLeft( $aGuiSettings[6][1], 1) = '$') ? eval(StringTrimLeft( $aGuiSettings[6][1], 1)) :  $aGuiSettings[6][1]

	;----------------------------------------------------------------------------------------------/
	; Erstellte die GUI
	;----------------------------------------------------------------------------------------------/
	$hGUI = GUICreate($APP('NAME'), $aGuiSettings[1][1], $aGuiSettings[2][1], $aGuiSettings[3][1], $aGuiSettings[4][1], $style, $exStyle)
	GUISetOnEvent($GUI_EVENT_CLOSE, '_vendor_roma_core_gui__ie_exit', $hGUI)
	GUICtrlCreateObj($oIE, 0, 0, $aGuiSettings[1][1], $aGuiSettings[2][1])

	;----------------------------------------------------------------------------------------------/
	; Zeige die GUI an 
	;----------------------------------------------------------------------------------------------/
	GUISetState(@SW_SHOW)

	;----------------------------------------------------------------------------------------------/
	; Navigiere zur IP
	;----------------------------------------------------------------------------------------------/
	_IENavigate($oIE, 'http://' & $APP('IP') & ':' & $APP('PORT'), 0)

endfunc

;----------------------------------------------------------------------------------------------/
; Beendet das Script wenn die GUI geschlossen wird.
;----------------------------------------------------------------------------------------------/
func _vendor_roma_core_gui__ie_exit()
	exit
endfunc
